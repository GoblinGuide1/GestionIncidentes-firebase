<!-- src/app/pages/home/home.page.html -->
<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title>Inicio</ion-title>
  </ion-toolbar>
</ion-header>

<ion-menu side="start" menuId="first" contentId="main-content">
  <ion-header>
    <ion-toolbar>
      <ion-title>Menú</ion-title>
    </ion-toolbar>
  </ion-header>
  <ion-content>
    <ion-list>
      <ion-item routerLink="/home">
        <ion-label>Inicio</ion-label>
      </ion-item>
      <ion-item *ngIf="hasRole([ 'Administrador'])" routerLink="/create-user">
        <ion-label>Crear Usuario</ion-label>
      </ion-item>
      <ion-item routerLink="/admin-users" *ngIf="hasRole(['Administrador'])">
        <ion-label>Administracion de usuarios</ion-label>
      </ion-item>
      <ion-item routerLink="/admin-roles" *ngIf="hasRole(['Supervisor', 'Administrador'])">
        <ion-label>Administracion de Roles</ion-label>
      </ion-item>
      <ion-item routerLink="/reportes" *ngIf="hasRole(['Encargado','Tecnico', 'Administrador','Usuario'])">
        <ion-label>Reportes del sistema</ion-label>
      </ion-item>
      <ion-item routerLink="/user-diagnog"*ngIf="hasRole(['Tecnico', 'Administrador'])">
        <ion-label>Diagnosticos creados</ion-label>
      </ion-item>
      <ion-item (click)="irpagina()">
        <ion-label>Cerrar Sesión</ion-label>
      </ion-item>
    </ion-list>
  </ion-content>
</ion-menu>

<ion-content id="main-content">
  <ion-card>
    <ion-card-header>
      <ion-card-title>Hola Bienvenido {{ nameUser }} </ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <p>Tus roles son:    <li *ngFor="let role of userRoles">{{ role }}</li>
      </p>
    </ion-card-content>

    <ion-button routerLink="/create-incidencia">Reportar Incidencias</ion-button>
  </ion-card>

  <ion-card  *ngIf="hasRole([ 'Tecnico','Administrador'])" >
    <ion-card-header>
      <ion-card-title>Incidencias Asignadas  </ion-card-title>
    </ion-card-header>
    <ion-card  *ngFor="let incidencia of incidenciasAsig">
      <ion-item>
        <ion-label>
          Título: {{incidencia.titulo}}
        </ion-label>
      </ion-item>
      <ion-item>
        <ion-label>
          Descripcion: {{incidencia.descripcion}}

        </ion-label>
        <ion-label>
          Estado: {{getEstadoDescriptivo(incidencia.idEstado)}}
        </ion-label>
      </ion-item>
      <ion-item>
        <ion-label>
          <img [src]="incidencia.imagen ">
        </ion-label>
      </ion-item>
      <ion-button *ngIf="hasRole(['Tecnico', 'Administrador'])" routerLink="/diagnos-incidencia" (click)="getIncidenciaId(incidencia)" [disabled]="isIncidenciaCerrada(incidencia)">Diagnosticar</ion-button>
      <ion-button *ngIf="hasRole(['Encargado', 'Administrador'])" routerLink="/asig-incidencia" (click)="getIncidenciaId(incidencia)">Asignar Incidencias </ion-button>
    </ion-card>
 
  </ion-card>

  <ion-card  *ngIf="hasRole(userRoles)" >
    <ion-card-header>
      <ion-card-title>Incidencias Creadas</ion-card-title>
    </ion-card-header>
  <ion-card  *ngFor="let incidencia of incidenciasUser">
    <ion-item>
      <ion-label>
        Título: {{incidencia.titulo}}
      </ion-label>
      <ion-label>
        Lugar: {{incidencia.lugar}}
      </ion-label>
    </ion-item>
    <ion-item>
      <ion-label>
        Descripción: {{incidencia.descripcion}}
      </ion-label>
      <ion-label>
        Estado: {{getEstadoDescriptivo(incidencia.idEstado)}}
      </ion-label>
    </ion-item>

    
    <ion-item>
      <ion-label>
        <img [src]="incidencia.imagen ">
      </ion-label>
    </ion-item>
    <ion-button *ngIf="hasRole(['Encargado', 'Administrador'])" routerLink="/asig-incidencia" (click)="getIncidenciaId(incidencia)">Asignar Incidencias </ion-button>
  </ion-card>
</ion-card>


<ion-card  *ngIf="hasRole(['Tecnico','Encargado', 'Administrador'])" >
  <ion-card-header>
    <ion-card-title>Incidencias Totales</ion-card-title>
  </ion-card-header>
<ion-card  *ngFor="let incidencia of incidencias">
  <ion-item>
    <ion-label>
      Título: {{incidencia.titulo}}
    </ion-label>
    <ion-label>
      Lugar: {{incidencia.lugar}}
    </ion-label>
  </ion-item>
  <ion-item>
    <ion-label>
      Descripción: {{incidencia.descripcion}}
    </ion-label>
    <ion-label>
      Estado: {{getEstadoDescriptivo(incidencia.idEstado)}}
    </ion-label>
  </ion-item>

  
  <ion-item>
    <ion-label>
      <img [src]="incidencia.imagen ">
    </ion-label>
  </ion-item>
  <ion-button *ngIf="hasRole(['Encargado', 'Administrador'])" routerLink="/asig-incidencia" (click)="getIncidenciaId(incidencia)">Asignar Incidencias </ion-button>

</ion-card>
</ion-card>

<ion-card  *ngIf="hasRole(['Supervisor', 'Administrador'])" >
  <ion-card-header>
    <ion-card-title>Incidencias Terminadas</ion-card-title>
  </ion-card-header>
<ion-card  *ngFor="let incidenciat of incidenciasT">
  <ion-item>
    <ion-label>
      Título: {{incidenciat.titulo}}
    </ion-label>
    <ion-label>
      Lugar: {{incidenciat.lugar}}
    </ion-label>
  </ion-item>
  <ion-item>
    <ion-label>
      Descripción: {{incidenciat.descripcion}}
    </ion-label>
    <ion-label>
      Estado: {{getEstadoDescriptivo(incidenciat.idEstado)}}
    </ion-label>
  </ion-item>

  
  <ion-item>
    <ion-label>
      <img [src]="incidenciat.imagen ">
    </ion-label>
  </ion-item>
  <ion-button *ngIf="hasRole(['Supervisor', 'Administrador'])" routerLink="/info-incidencia" (click)="getIncidenciaId(incidenciat)">Ver Resultado</ion-button>
</ion-card>
</ion-card>

</ion-content>
